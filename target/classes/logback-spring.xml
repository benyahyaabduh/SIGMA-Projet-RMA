<?xml version="1.0" encoding="UTF-8"?>
<configuration>
	<property name="LOG_PATH" value="logs"/>
	<appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
		<layout class="ch.qos.logback.classic.PatternLayout">
			<pattern>%d{yyyy-MM-dd} | %d{HH:mm:ss.SSS} | %-20.20thread | %5p | %-30.30logger{25} | %8mdc{connected} | %8mdc{adress} | %m%n | %throwable</pattern>
		</layout>
	</appender>

	<appender name="SAVE-TO-FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
		<file>${LOG_PATH}/transverse/prestataire/middleware_new/log.log</file>
		<filter class="ch.qos.logback.classic.filter.LevelFilter">
			<level>ERROR</level>
			<onMatch>DENY</onMatch>
		</filter>
		<encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
			<pattern>%d{yyyy-MM-dd} %d{HH:mm:ss.SSS} %-20.20thread %5p %-30.30logger{25} %8mdc{connected} %8mdc{adress} %m%n %throwable</pattern>
		</encoder>
		<rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
			<fileNamePattern>${LOG_PATH}/transverse/prestataire/middleware_new/archived/log_%d{dd-MM-yyyy}_%i.log</fileNamePattern>
			<maxFileSize>10MB</maxFileSize>
			<maxHistory>10</maxHistory>
			<totalSizeCap>100MB</totalSizeCap>
		</rollingPolicy>
	</appender>

	<appender name="SAVE-TO-ERRORS" class="ch.qos.logback.core.rolling.RollingFileAppender">
		<file>${LOG_PATH}/transverse/prestataire/middleware_new/log.error</file>
		<filter class="ch.qos.logback.classic.filter.LevelFilter">
			<level>ERROR</level>
			<onMatch>ACCEPT</onMatch>
		</filter>
		<filter class="ch.qos.logback.classic.filter.LevelFilter">
			<level>INFO</level>
			<onMatch>DENY</onMatch>
		</filter>
		<filter class="ch.qos.logback.classic.filter.LevelFilter">
			<level>WARN</level>
			<onMatch>DENY</onMatch>
		</filter>
		<encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
			<pattern>%d{yyyy-MM-dd} %d{HH:mm:ss.SSS} %-20.20thread %5p %-30.30logger{25} %8mdc{connected} %8mdc{adress} %m%n %throwable</pattern>
		</encoder>
		<rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
			<fileNamePattern>${LOG_PATH}/transverse/prestataire/middleware_new/archived/log_%d{dd-MM-yyyy}_%i.error</fileNamePattern>
			<maxFileSize>5MB</maxFileSize>
			<maxHistory>10</maxHistory>
			<totalSizeCap>50MB</totalSizeCap>
		</rollingPolicy>
	</appender>



	<!-- config for STDOUT and SAVE-TO-FILE -->

	<springProfile name="default,it,local,podman">
		<root level="info">
			<appender-ref ref="STDOUT" />
		</root>
		<logger name="com.rma.tiers" additivity="false" level="debug">
			<appender-ref ref="STDOUT" />
		</logger>
	</springProfile>
	<springProfile name="prod,rec,dev,podman">
		<root level="info">
			<appender-ref ref="SAVE-TO-FILE" />
			<appender-ref ref="SAVE-TO-ERRORS" />
		</root>

	</springProfile>



</configuration>